<!DOCTYPE html>

<html>
        <head>
            <meta charset="utf-8">
            <title>Results!</title>
            <style>
            h1 {
                text-align: center;
                background-color: rgb(51,51,51);
                color: white;
                padding-top: 25px;
                padding-bottom: 25px;
                margin-block-end: 0px;
                margin-block-start: 0px;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                margin: 0;
            }

            table {
                margin-left: 6%;
                margin-right: 6%;
                width: 90%;
                text-align: center;
            }

            /* #shortlist {
                margin-left: 8% !important;
            } */

            tr, td {
                padding-left: 10px;
                padding-right: 10px;
            }

            table, th, td {
                border: 1px solid;
            }

            tr:hover {
                background-color: lightgray;
            }

            button { 
                background-color: rgb(51, 51, 51);
                border: 1px solid #555;
                color: white;   
                text-align: center;
                text-decoration: none;
                display: inline-block;
                border-radius: 8px;
                cursor: pointer;
            }

            button:hover {
                background-color: rgb(85, 85, 85);
            }
            </style>
        </head>

        <body>
        <h1>Team Finder</h1>
        
        <div>
            <h2 style="text-align: center;">Result</h2>
        </div>

        <div style="text-align: center;">
            <table id="results" style="border: 1px solid black">
                <tr>
                    <th>Name</th>
                    <th>Experience</th>
                    <th>Qualifications</th>
                    <th>Year Joined</th>
                    <th>Location</th>
                    <th>OU</th>
                    <th>Contact</th>
                    <th>Grade</th>
                    <th>Skills</th>
                    <th>Current Project</th>
                    <th>Availability</th>
                    <th>Shortlist</th>
                    <th>Remove</th>
                </tr>
            </table>
        </div>

        <br>
        <!-- <h2 style="text-align: center;"><a href="/shortlist">Shortlist</a></h2>
        <div class="table">
            <table id="shortlist" style="border: 1px solid black">
                
            </table>
        </div> -->

        <script>
            script-placeholder

            let people = JSON.parse(localStorage.getItem('people')) || [];
            let removal = JSON.parse(localStorage.getItem('removal')) || [];
 
            function btn(i) {
                //document.getElementById('shortlist').insertAdjacentHTML("beforeend", `<tr><a href='#row-${i + 1}'>Person #${i + 1}</a></tr>`);
                document.getElementById(`btn-${i + 1}`).disabled = true;
                document.getElementById(`btn-${i + 1}`).style.backgroundColor = "rgb(85, 85, 85)";
                document.getElementById(`btn-${i + 1}`).style.cursor = "not-allowed";

                people.push(data[i]);
                localStorage.removeItem('people');
                localStorage.setItem(`people`, JSON.stringify(people));
            };

            function remove(i) {
                const node = document.getElementById(`remove-${i + 1}`).parentNode.parentNode.parentNode;
                document.getElementById('results').removeChild(node);

                removal.push(data[i]);
                localStorage.removeItem('removal');
                localStorage.setItem('removal', JSON.stringify(removal));
            };

            const personToTable = (person, i) => {
                return `<tr id="row-${i + 1}">
                    <td>${person.name}</td>
                    <td>${person.experience}</td>
                    <td>${person.qualifications}</td>
                    <td>${person.year_joined}</td>
                    <td>${person.location}</td>
                    <td>${person.ou}</td>
                    <td>${person.contact_info}</td>
                    <td>${person.grade}</td>
                    <td>${person.skills}</td>
                    <td>${person.current_project}</td>
                    <td>${person.availability}</td>
                    <td><button onclick="btn(${i})" id="btn-${i + 1}">Shortlist</button></td>
                    <td><button onclick="remove(${i})" id="remove-${i + 1}">Remove</button></td>
                </tr>`;
            };

            for (let i = 0; i < data.length; i++) {
                if (!JSON.stringify(removal).includes(JSON.stringify(data[i])) && !JSON.stringify(people).includes(JSON.stringify(data[i]))) {
                    document.getElementById('results').insertAdjacentHTML("beforeend", personToTable(data[i], i));
                };
            };
        </script>

        <h4 style="text-align: center;"><a href="/shortlist" style="color: black !important; text-decoration: none !important;">Go to shortlist</a></h4>
        <h4 style="text-align: center;"><a href="/" style="color: black !important; text-decoration: none !important;">Back to home</a></h4>
    </body>
</html>